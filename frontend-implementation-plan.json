{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Real-Time Stock Price Display and Live Price Graph",
  "requirements": [
    {
      "id": "REQ-26",
      "summary": "Add simulated real-time price feed mechanism with `getLivePrice` utility and `useLivePrice` React hook",
      "acceptanceCriteria": [
        "`getLivePrice(symbol)` returns a numeric price that drifts slightly from the previous value on each call.",
        "`useLivePrice(symbol)` hook returns `{ price, previousPrice, changePercent, isUp }` and updates on the configured interval.",
        "The hook cleans up its interval on unmount.",
        "No external API calls are made; all data is derived from the existing mock OHLCV data."
      ],
      "file_operations": [
        {
          "path": "frontend/src/data/mockStocks.ts",
          "operation": "modify",
          "description": "Add `getLivePrice(symbol: string): number` utility function that applies a small random walk delta (Â±0.5%) to the stock's last OHLCV close price on each call to simulate live price movement. Store the current simulated price in a Map<string, number> to enable price drift across calls. Initialize prices from the last OHLCV close on first access per symbol."
        },
        {
          "path": "frontend/src/hooks/useLivePrice.ts",
          "operation": "create",
          "description": "Create `useLivePrice(symbol: string, intervalMs?: number)` React hook that uses `setInterval` (default 3000ms) to repeatedly call `getLivePrice(symbol)` from mockStocks.ts. Return `{ price: number, previousPrice: number, changePercent: number, isUp: boolean }` where changePercent is calculated relative to the session-start price (first price captured). Track the session-open price and previous tick price in state. Clean up the interval on unmount using useEffect cleanup."
        }
      ]
    },
    {
      "id": "REQ-27",
      "summary": "Create `LivePriceTicker` component displaying real-time price with color-coded changes and pulse animation",
      "acceptanceCriteria": [
        "`LivePriceTicker` renders symbol, current price, absolute change, and percentage change.",
        "Price text is green when the latest tick is higher than the previous and red when lower.",
        "A brief CSS animation (pulse or flash) plays on each new price value.",
        "Component is styled with `GlassCard` and matches the dark-finance theme."
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/LivePriceTicker.tsx",
          "operation": "create",
          "description": "Create `LivePriceTicker` component accepting a `symbol` prop. Use the `useLivePrice` hook to get current price, previousPrice, changePercent, and isUp. Display the stock symbol, current live price formatted to 2 decimal places, absolute price change (current - session-open), and percentage change since session start. Apply green text color when isUp is true and red when false. Add a CSS pulse animation triggered via a key or animation class whenever the price value changes. Wrap the content in a `GlassCard` component to match the platform's dark-finance glassmorphism theme with teal/gold accents."
        },
        {
          "path": "frontend/src/index.css",
          "operation": "modify",
          "description": "Add a @keyframes pulse animation definition (e.g., scale or opacity pulse lasting ~300ms) for use by the `LivePriceTicker` component to visually indicate price updates."
        }
      ]
    },
    {
      "id": "REQ-28",
      "summary": "Create `LivePriceChart` component rendering a rolling real-time line chart with 60 ticks",
      "acceptanceCriteria": [
        "Chart maintains a rolling window of up to 60 price points and appends new ticks every ~3 seconds.",
        "The line color is teal when current price is at or above the session-open price and red when below.",
        "A `ReferenceLine` marks the session-open price.",
        "Custom tooltip shows formatted price and elapsed time.",
        "Chart updates smoothly without full re-mounts on each tick."
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/LivePriceChart.tsx",
          "operation": "create",
          "description": "Create `LivePriceChart` component accepting a `symbol` prop. Use the `useLivePrice` hook with a 3-second interval. Maintain a rolling buffer of up to 60 price ticks in a useRef-backed array, appending new ticks on each update and slicing to keep only the last 60. Store the session-open price (first tick) in a ref. Render a Recharts `LineChart` with: a `Line` component colored teal if current price >= session-open price, red otherwise; no X-axis labels (just time-ordered index); a Y-axis showing the price range with domain adjusted to [min, max] of buffered prices; a `ReferenceLine` at the session-open price; and a custom `Tooltip` showing formatted price and relative elapsed time (e.g., '0:30' for 30 seconds). Use `isAnimationActive={false}` or a stable key to prevent full re-mounts on each tick."
        }
      ]
    },
    {
      "id": "REQ-29",
      "summary": "Integrate `LivePriceTicker` and `LivePriceChart` into Stock Playground page with clear labelling",
      "acceptanceCriteria": [
        "`LivePriceTicker` is shown for the currently selected stock symbol on the Stock Playground page.",
        "`LivePriceChart` is rendered in a `GlassCard` and updates in real time as the user views the page.",
        "Existing historical `StockPriceChart` is still present and labelled 'Historical Price'.",
        "The live chart is labelled 'Live Price' to distinguish it from the historical view."
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/StockPlaygroundPage.tsx",
          "operation": "modify",
          "description": "Import `LivePriceTicker` and `LivePriceChart` components. When a user selects a stock symbol (when `selectedSymbol` is set), render the `LivePriceTicker` component for that symbol prominently above the prediction form. Below or beside the ticker, render the `LivePriceChart` component wrapped in a `GlassCard` with a heading 'Live Price' to clearly distinguish it from the existing historical chart. Add a heading 'Historical Price' above the existing `StockPriceChart` component to clarify its purpose. Ensure both charts and the ticker are visible simultaneously when a stock is selected."
        }
      ]
    },
    {
      "id": "REQ-30",
      "summary": "Integrate `LivePriceTicker` into Portfolio Analyzer page with live P&L updates",
      "acceptanceCriteria": [
        "Each holding row in the Portfolio Analyzer shows a live-updating price via `LivePriceTicker`.",
        "Total portfolio value and unrealized gain/loss figures update automatically as live prices change.",
        "No backend calls are introduced; all live price data comes from the frontend `useLivePrice` hook.",
        "UI remains stable and does not flicker excessively during price updates."
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/PortfolioAnalyzerPage.tsx",
          "operation": "modify",
          "description": "Import `LivePriceTicker` and `useLivePrice` hook. For each holding displayed in the holdings table/list, render a `LivePriceTicker` component inline in the 'Current Price' column showing the real-time simulated price for that holding's stock symbol. Replace or augment the static price display with live prices. Calculate unrealized gain/loss and total portfolio value using the live price from `useLivePrice` for each holding. Use React state or memoization to aggregate live prices across all holdings and update the displayed total portfolio value and P&L figures in real time. Ensure the UI updates smoothly without excessive re-renders by using stable keys and memoized calculations."
        }
      ]
    }
  ]
}